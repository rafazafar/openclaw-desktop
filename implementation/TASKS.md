# Implementation Task List — openclaw-desktop

This is the **source of truth** for the cron-driven implementation work.

## How the cron uses this file
- Each run picks the **top-most unchecked** task in **P0 / M1** first.
- It implements that task (code + tests where appropriate).
- It marks the task ✅ with date + short note, commits to `master`, and pushes.

Conventions:
- Tasks are written so they can be completed in ~15 minutes to ~2 hours.
- Prefer vertical slices that end in a runnable state.
- Avoid large refactors until a baseline is running.

---

## Milestone M1 — Desktop manager MVP (Telegram)
Goal: user can install/run the desktop app, turn OpenClaw gateway On/Off, connect Telegram, see status + basic logs.

### P0-FOUNDATION (skeleton)
- [x] **T0.1 Repo scaffolding (monorepo skeleton)** ✅ 2026-02-04 — Added repo folders + placeholder READMEs; added root package/tooling skeleton.
  - Create folders per `docs/REPO_STRUCTURE.md`:
    - `apps/desktop/`, `apps/manager/`, `packages/core/`, `packages/integrations/`, `packages/policy/`
  - Add minimal placeholder READMEs in each folder.
  - Add root tooling skeleton (format/lint/test scripts) *without* heavy implementation.

- [x] **T0.2 Manager service skeleton (TypeScript)** ✅ 2026-02-04 — Added Node HTTP manager bound to 127.0.0.1 with `GET /status` (stubbed) + `x-openclaw-token` auth; includes a small vitest.
  - Minimal HTTP server binding to `127.0.0.1`.
  - Implement `GET /status` returning stubbed gateway status.
  - Add local auth token plumbing (static token in dev; real token later).

- [x] **T0.3 Desktop app skeleton** ✅ 2026-02-04 — Chose Electron (documented in `docs/DECISIONS.md`); added a minimal window with Home UI that calls manager `GET /status` via preload bridge (On/Off stubbed until T1.1).
  - Choose framework (record decision in `docs/DECISIONS.md`).
  - Basic window with Home screen and an On/Off button wired to manager API.

### P0-GATEWAY LIFECYCLE
- [x] **T1.1 Gateway process control (start/stop/restart)** ✅ 2026-02-04 — Manager now proxies `openclaw gateway` via controller; added POST /gateway/start|stop|restart + idempotent no-op when already in target state.
  - Implement start/stop/restart in manager.
  - Idempotency rules per PRD.

- [x] **T1.2 Status polling + transient states** ✅ 2026-02-04 — Desktop now auto-polls `/status` every 2s and shows running/stopped/starting/stopping states.
  - Gateway control button calls manager start/stop and reflects transient states while actions are in-flight.

### P0-INTEGRATIONS: TELEGRAM
- [x] **T2.1 Telegram integration: data model + storage** ✅ 2026-02-04 — Added manager state store (JSON in app data) with Telegram token storage (dev-only) and `/status` now returns Telegram connection state (no secret values).
  - Store bot token securely (dev: env/file; later: keychain).
  - Represent integration connection state in manager.

- [x] **T2.2 Telegram connect flow (UI + manager)** ✅ 2026-02-04 — Added POST `/integrations/telegram/connect` with Telegram `getMe` validation + state persistence; desktop UI can enter token and connect.
  - UI: token input + connect button.
  - Manager: validate token (basic) and persist.

- [x] **T2.3 Telegram disconnect flow** ✅ 2026-02-04 — Added manager POST `/integrations/telegram/disconnect` (clears stored token) + desktop Disconnect button.
  - UI disconnect.
  - Manager removes token/config.

### P0-CONFIG GENERATION
- [ ] **T3.1 Generated OpenClaw config (MVP)**
  - Manager generates a minimal OpenClaw config file/artifact.
  - Include header: generated by openclaw-desktop.

- [ ] **T3.2 Safe writes + rollback**
  - Atomic write strategy (tmp + rename) per `docs/CONFIG_GENERATION.md`.

### P0-OBSERVABILITY
- [ ] **T4.1 Basic logs surface**
  - Manager exposes recent logs path/lines.
  - Desktop shows last N lines and copy button.

- [ ] **T4.2 Diagnostics checklist (minimal)**
  - Implement `/diagnostics/run` returning a few checks.

---

## Milestone M2 — Permissions framework
- [ ] T5.1 Permission catalog v1
- [ ] T5.2 Permissions UI screen
- [ ] T5.3 Policy enforcement hook (confirm-before-send baseline)
- [ ] T5.4 Audit log JSONL

---

## Milestone M3 — Gmail read-only
- [ ] T6.1 BYO OAuth creds UI
- [ ] T6.2 OAuth flow + token storage
- [ ] T6.3 Gmail read-only integration wiring

---

## Notes / constraints
- Prefer local-first development.
- Do not build “full chat UI” yet; use Telegram for interaction.
- Avoid shipping secrets in repo.
